<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: EventMachine::ActionCable::Client
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "EventMachine::ActionCable::Client";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../EventMachine.html" title="EventMachine (module)">EventMachine</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ActionCable.html" title="EventMachine::ActionCable (module)">ActionCable</a></span></span>
     &raquo; 
    <span class="title">Client</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: EventMachine::ActionCable::Client
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">EventMachine::ActionCable::Client</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/em/action_cable/client.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>ActionCable client using EventMachine sockets. ActionCable is a WebSocket
wrapper protocol used in Rails and adding a bit more structure around
message passing, providing multiplexing (use of channels) and utilizing
keep-alive messages. State machine is simplified and will get confused in
some edge cases around subscribing/unsubscribing/closing/reconnecting in
rapid succession. So don&#39;t subscribe while closingâ€¦</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Client/Command.html" title="EventMachine::ActionCable::Client::Command (module)">Command</a></span>, <span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span>, <span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span>
    
  
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="URL_SCHEME_REGEX-constant" class="">URL_SCHEME_REGEX =
          <div class="docstring">
  <div class="discussion">
    
<p>Assuming <strong>authority</strong> (host at least) is provided after this.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>\A(?&lt;scheme&gt;[a-z][a-z0-9+\-.]*)://</span><span class='regexp_end'>}i</span></span></pre></dd>
      
        <dt id="SECURE_URL_SCHEMES-constant" class="">SECURE_URL_SCHEMES =
          
        </dt>
        <dd><pre class="code"><span class='const'>Set</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ftps</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hxxps</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rtsps</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sftp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wss</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="HTTP_SCHEMES-constant" class="">HTTP_SCHEMES =
          
        </dt>
        <dd><pre class="code"><span class='const'>Set</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="WEBSOCKET_SCHEMES-constant" class="">WEBSOCKET_SCHEMES =
          
        </dt>
        <dd><pre class="code"><span class='const'>Set</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wss</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ws</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#logger-class_method" title="logger (class method)">.<strong>logger</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Class methods.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#logger=-class_method" title="logger= (class method)">.<strong>logger=</strong>(logger)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#normalize_websocket_url-class_method" title="normalize_websocket_url (class method)">.<strong>normalize_websocket_url</strong>(url)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert provided URL to ws/wss protocol.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#channel_state-instance_method" title="#channel_state (instance method)">#<strong>channel_state</strong>(channel)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>  &#x21d2; Client </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Connect to the server and proceed with automatic subscription to all
channels, after the welcome.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connected%3F-instance_method" title="#connected? (instance method)">#<strong>connected?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fully_connected_and_subscribed%3F-instance_method" title="#fully_connected_and_subscribed? (instance method)">#<strong>fully_connected_and_subscribed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(uri, http_headers: nil, reconnect: nil, welcome_timeout: nil)  &#x21d2; Client </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initialize a connection, but don&#39;t connect.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_connect_failed-instance_method" title="#on_connect_failed (instance method)">#<strong>on_connect_failed</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_connected-instance_method" title="#on_connected (instance method)">#<strong>on_connected</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when TCP/SSL connection is completed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_custom_message_received-instance_method" title="#on_custom_message_received (instance method)">#<strong>on_custom_message_received</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when messages are received other than &#39;ping&#39;,
&#39;welcome&#39;, and &#39;confirm_subscription&#39;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_disconnected-instance_method" title="#on_disconnected (instance method)">#<strong>on_disconnected</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when TCP/SSL connection (socket) is closed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_pinged-instance_method" title="#on_pinged (instance method)">#<strong>on_pinged</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when &#39;ping&#39; message is received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_subscribed-instance_method" title="#on_subscribed (instance method)">#<strong>on_subscribed</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when &#39;confirm_subscription&#39; message is
received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_welcomed-instance_method" title="#on_welcomed (instance method)">#<strong>on_welcomed</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provide callback for when &#39;welcome&#39; message is received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_message-instance_method" title="#send_message (instance method)">#<strong>send_message</strong>(message, channel: nil)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This DOES NOT queue messages.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#state-instance_method" title="#state (instance method)">#<strong>state</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subscribe_to_channel-instance_method" title="#subscribe_to_channel (instance method)">#<strong>subscribe_to_channel</strong>(channel)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Subscribe to a channel (or indicate the desire to do so when the connection
is established).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsubscribe_from_channel-instance_method" title="#unsubscribe_from_channel (instance method)">#<strong>unsubscribe_from_channel</strong>(channel)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcome_timeout-instance_method" title="#welcome_timeout (instance method)">#<strong>welcome_timeout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcome_timeout=-instance_method" title="#welcome_timeout= (instance method)">#<strong>welcome_timeout=</strong>(val)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(uri, http_headers: nil, reconnect: nil, welcome_timeout: nil)  &#x21d2; <tt><span class='object_link'><a href="" title="EventMachine::ActionCable::Client (class)">Client</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initialize a connection, but don&#39;t connect.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>URI to connect client to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>http_headers</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>HTTP headers to supply during connection attempts. If nil, &#39;origin&#39;
will be defaulted based on the uri.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>reconnect</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Reconnect.html" title="EventMachine::ActionCable::Reconnect (class)">Reconnect</a></span>?</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Reconnection algorithm.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>welcome_timeout</span>
      
      
        <span class='type'>(<tt>Number?</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Timeout in seconds between attempted connects and welcome being received</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='label'>http_headers:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>reconnect:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>welcome_timeout:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
	<span class='ivar'>@_channels</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='comment'># id, txt (version of the identifier), state
</span>	<span class='ivar'>@_connection</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_explicit_close</span> <span class='op'>=</span> <span class='kw'>false</span>
	<span class='ivar'>@_http_headers</span> <span class='op'>=</span> <span class='id identifier rubyid_http_headers'>http_headers</span>
	<span class='ivar'>@_on_connected_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_connect_failed_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_custom_message_received_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_disconnected_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_pinged_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_subscribed_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_subscribed_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_on_welcomed_block</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_reconnect</span> <span class='op'>=</span> <span class='id identifier rubyid_reconnect'>reconnect</span>
	<span class='ivar'>@_reconnect</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@_reconnect</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
	<span class='ivar'>@_uri</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_normalize_websocket_url'>normalize_websocket_url</span> <span class='id identifier rubyid_uri'>uri</span>
	<span class='ivar'>@_state</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTED (constant)">DISCONNECTED</a></span></span>
	<span class='ivar'>@_state_timer</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='ivar'>@_welcome_timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_welcome_timeout'>welcome_timeout</span>

	<span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='ivar'>@_uri</span>
	<span class='kw'>if</span> <span class='ivar'>@_http_headers</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
		<span class='comment'># Assumptions about origin in the default case (if it&#39;s using secure stuff, assume secure ws).
</span>		<span class='id identifier rubyid_is_secure'>is_secure</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#SECURE_URL_SCHEMES-constant" title="EventMachine::ActionCable::Client::SECURE_URL_SCHEMES (constant)">SECURE_URL_SCHEMES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_is_secure'>is_secure</span>
			<span class='id identifier rubyid_port_part'>port_part</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='int'>443</span> <span class='op'>==</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>else</span>
			<span class='id identifier rubyid_port_part'>port_part</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='int'>80</span> <span class='op'>==</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>
		<span class='id identifier rubyid_origin'>origin</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_is_secure'>is_secure</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port_part'>port_part</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
		<span class='ivar'>@_http_headers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>origin:</span> <span class='id identifier rubyid_origin'>origin</span><span class='rbrace'>}</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="logger-class_method">
  
    .<strong>logger</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Class methods</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 55</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span>
	<span class='kw'>return</span> <span class='ivar'>@logger</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="logger=-class_method">
  
    .<strong>logger=</strong>(logger)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 59</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_logger='>logger=</span><span class='lparen'>(</span><span class='id identifier rubyid_logger'>logger</span><span class='rparen'>)</span>
	<span class='ivar'>@logger</span> <span class='op'>=</span> <span class='id identifier rubyid_logger'>logger</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="normalize_websocket_url-class_method">
  
    .<strong>normalize_websocket_url</strong>(url)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert provided URL to ws/wss protocol.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 64</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_normalize_websocket_url'>normalize_websocket_url</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_url_match'>url_match</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#URL_SCHEME_REGEX-constant" title="EventMachine::ActionCable::Client::URL_SCHEME_REGEX (constant)">URL_SCHEME_REGEX</a></span></span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span> <span class='id identifier rubyid_url'>url</span>
	<span class='kw'>if</span> <span class='id identifier rubyid_url_match'>url_match</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='comment'># ASSUMPTION: Not fully qualified.
</span>		<span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ws://</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_url'>url</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_scheme'>scheme</span> <span class='op'>=</span> <span class='id identifier rubyid_url_match'>url_match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
		<span class='kw'>if</span> <span class='const'><span class='object_link'><a href="#HTTP_SCHEMES-constant" title="EventMachine::ActionCable::Client::HTTP_SCHEMES (constant)">HTTP_SCHEMES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_scheme'>scheme</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ws</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_url'>url</span><span class='lbracket'>[</span><span class='int'>4</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
		<span class='kw'>elsif</span> <span class='op'>!</span><span class='const'><span class='object_link'><a href="#WEBSOCKET_SCHEMES-constant" title="EventMachine::ActionCable::Client::WEBSOCKET_SCHEMES (constant)">WEBSOCKET_SCHEMES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_scheme'>scheme</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ws</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_url'>url</span><span class='lbracket'>[</span><span class='id identifier rubyid_scheme'>scheme</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_url'>url</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="channel_state-instance_method">
  
    #<strong>channel_state</strong>(channel)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


120
121
122
123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 120</span>

<span class='kw'>def</span> <span class='id identifier rubyid_channel_state'>channel_state</span><span class='lparen'>(</span><span class='id identifier rubyid_channel'>channel</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_channel_key'>channel_key</span> <span class='op'>=</span> <span class='id identifier rubyid_make_channel_key'>make_channel_key</span> <span class='id identifier rubyid_channel'>channel</span>
	<span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
	<span class='id identifier rubyid_ch'>ch</span> <span class='op'>=</span> <span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_el'>el</span><span class='op'>|</span> <span class='lparen'>(</span><span class='id identifier rubyid_el'>el</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='rparen'>)</span><span class='rbrace'>}</span>
	<span class='kw'>return</span> <span class='id identifier rubyid_ch'>ch</span><span class='op'>&amp;.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:state</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    #<strong>close</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 127</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
	<span class='kw'>if</span> <span class='op'>!</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTING (constant)">DISCONNECTING</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTED (constant)">DISCONNECTED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='ivar'>@_connection</span><span class='rparen'>)</span>
		<span class='ivar'>@_explicit_close</span> <span class='op'>=</span> <span class='kw'>true</span>
		<span class='ivar'>@_state</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTING (constant)">DISCONNECTING</a></span></span>
		<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connect-instance_method">
  
    #<strong>connect</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="EventMachine::ActionCable::Client (class)">Client</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Connect to the server and proceed with automatic subscription to all
channels, after the welcome. May be called only while the
EventMachine/reactor run loop is running (EM::reactor_running? == true).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="EventMachine::ActionCable::Client (class)">Client</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 143</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span>
	<span class='kw'>if</span> <span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTING (constant)">DISCONNECTING</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTED (constant)">DISCONNECTED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='ivar'>@_state</span><span class='rparen'>)</span>
		<span class='comment'># Somewhere down the chain &#39;headers&#39; is being modified in place apparently (bug?), so dup it.
</span>		<span class='ivar'>@_state</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTING (constant)">CONNECTING</a></span></span>
		<span class='id identifier rubyid_start_welcome_timer'>start_welcome_timer</span> <span class='ivar'>@_welcome_timeout</span>

		<span class='ivar'>@_connection</span> <span class='op'>=</span> <span class='const'>WebSocket</span><span class='op'>::</span><span class='const'>EventMachine</span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='label'>uri:</span> <span class='ivar'>@_uri</span><span class='comma'>,</span> <span class='label'>headers:</span> <span class='ivar'>@_http_headers</span><span class='op'>&amp;.</span><span class='id identifier rubyid_dup'>dup</span><span class='rparen'>)</span>

		<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_onopen'>onopen</span> <span class='kw'>do</span>
			<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> opened.</span><span class='tstring_end'>&quot;</span></span>
			<span class='id identifier rubyid_transition_state'>transition_state</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTED (constant)">CONNECTED</a></span></span><span class='comma'>,</span> <span class='ivar'>@_on_connected_block</span><span class='comma'>,</span> <span class='symbol'>:on_open</span>
		<span class='kw'>end</span>

		<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_onclose'>onclose</span> <span class='kw'>do</span>
			<span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTING (constant)">CONNECTING</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTED (constant)">CONNECTED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='ivar'>@_state</span>
			<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>failed to connect</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>closed</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
			<span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_channel'>channel</span><span class='op'>|</span> <span class='id identifier rubyid_channel'>channel</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#UNSUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::UNSUBSCRIBED (constant)">UNSUBSCRIBED</a></span></span><span class='rbrace'>}</span>
			<span class='id identifier rubyid_rm'>rm</span> <span class='op'>=</span> <span class='op'>!</span><span class='ivar'>@_explicit_close</span> <span class='op'>?</span> <span class='symbol'>:on_close</span> <span class='op'>:</span> <span class='kw'>nil</span>
			<span class='ivar'>@_explicit_close</span> <span class='op'>=</span> <span class='kw'>false</span>
			<span class='id identifier rubyid_transition_state'>transition_state</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTED (constant)">DISCONNECTED</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>?</span> <span class='ivar'>@_on_connect_failed_block</span> <span class='op'>:</span> <span class='ivar'>@_on_disconnected_block</span><span class='comma'>,</span>
				<span class='id identifier rubyid_rm'>rm</span>
		<span class='kw'>end</span>

		<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_onerror'>onerror</span> <span class='kw'>do</span>
			<span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTING-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTING (constant)">CONNECTING</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTED (constant)">CONNECTED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='ivar'>@_state</span>
			<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>failed to connect</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>closed (error)</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
			<span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_channel'>channel</span><span class='op'>|</span> <span class='id identifier rubyid_channel'>channel</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#UNSUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::UNSUBSCRIBED (constant)">UNSUBSCRIBED</a></span></span><span class='rbrace'>}</span>
			<span class='id identifier rubyid_rm'>rm</span> <span class='op'>=</span> <span class='op'>!</span><span class='ivar'>@_explicit_close</span> <span class='op'>?</span> <span class='symbol'>:on_close</span> <span class='op'>:</span> <span class='kw'>nil</span>
			<span class='ivar'>@_explicit_close</span> <span class='op'>=</span> <span class='kw'>false</span>
			<span class='id identifier rubyid_transition_state'>transition_state</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#DISCONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::DISCONNECTED (constant)">DISCONNECTED</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_f2c'>f2c</span> <span class='op'>?</span> <span class='ivar'>@_on_connect_failed_block</span> <span class='op'>:</span> <span class='ivar'>@_on_disconnected_block</span><span class='comma'>,</span>
				<span class='id identifier rubyid_rm'>rm</span>
		<span class='kw'>end</span>

		<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_onmessage'>onmessage</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid__type'>_type</span><span class='op'>|</span> <span class='id identifier rubyid_on_received'>on_received</span> <span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> connect() ignored in current state </span><span class='embexpr_beg'>#{</span><span class='ivar'>@_state</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connected?-instance_method">
  
    #<strong>connected?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 136</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connected?'>connected?</span>
	<span class='kw'>return</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#CONNECTED-constant" title="EventMachine::ActionCable::Client::ConnectionState::CONNECTED (constant)">CONNECTED</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#WELCOMED-constant" title="EventMachine::ActionCable::Client::ConnectionState::WELCOMED (constant)">WELCOMED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='ivar'>@_state</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fully_connected_and_subscribed?-instance_method">
  
    #<strong>fully_connected_and_subscribed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fully_connected_and_subscribed?'>fully_connected_and_subscribed?</span>
	<span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#WELCOMED-constant" title="EventMachine::ActionCable::Client::ConnectionState::WELCOMED (constant)">WELCOMED</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='ivar'>@_state</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
			<span class='op'>!</span><span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#SUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::SUBSCRIBED (constant)">SUBSCRIBED</a></span></span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="logger-instance_method">
  
    #<strong>logger</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 226</span>

<span class='kw'>def</span> <span class='id identifier rubyid_logger'>logger</span>
	<span class='kw'>return</span> <span class='const'><span class='object_link'><a href="../../EventMachine.html" title="EventMachine (module)">EventMachine</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../ActionCable.html" title="EventMachine::ActionCable (module)">ActionCable</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="EventMachine::ActionCable::Client (class)">Client</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="#logger-class_method" title="EventMachine::ActionCable::Client.logger (method)">logger</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_connect_failed-instance_method">
  
    #<strong>on_connect_failed</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_connect_failed'>on_connect_failed</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_connect_failed_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_connected-instance_method">
  
    #<strong>on_connected</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when TCP/SSL connection is completed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_connected'>on_connected</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_connected_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_custom_message_received-instance_method">
  
    #<strong>on_custom_message_received</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when messages are received other than &#39;ping&#39;,
&#39;welcome&#39;, and &#39;confirm_subscription&#39;. block(message) is
called. <strong>message</strong> is a hash if JSON decoded properly,
otherwise string.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 199</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_custom_message_received'>on_custom_message_received</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_custom_message_received_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_disconnected-instance_method">
  
    #<strong>on_disconnected</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when TCP/SSL connection (socket) is closed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 204</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_disconnected'>on_disconnected</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_disconnected_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_pinged-instance_method">
  
    #<strong>on_pinged</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when &#39;ping&#39; message is received.
block(message) is called. <strong>message</strong> is a hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_pinged'>on_pinged</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_pinged_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_subscribed-instance_method">
  
    #<strong>on_subscribed</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when &#39;confirm_subscription&#39; message is
received. block(identifier) is called. <strong>identifier</strong> is a
hash (the subscription identifier).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_subscribed'>on_subscribed</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_subscribed_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_welcomed-instance_method">
  
    #<strong>on_welcomed</strong>(&amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Provide callback for when &#39;welcome&#39; message is received.
block(message) is called. <strong>message</strong> is a hash.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_welcomed'>on_welcomed</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
	<span class='ivar'>@_on_welcomed_block</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="send_message-instance_method">
  
    #<strong>send_message</strong>(message, channel: nil)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This DOES NOT queue messages. Message should likely include
&#39;action&#39; attribute.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Object sent to the ActionCable server. This should include &#39;action&#39;
attribute which is the METHOD called on the server-side channel.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>channel</span>
      
      
        <span class='type'>(<tt>Hash or String</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Number of messages sent (0 if no channels in the SUBSCRIBED state).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


236
237
238
239
240
241
242
243
244
245
246
247
248
249</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid_send_message'>send_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='label'>channel:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_messages_sent'>messages_sent</span> <span class='op'>=</span> <span class='int'>0</span>
	<span class='id identifier rubyid_channel_key'>channel_key</span> <span class='op'>=</span> <span class='id identifier rubyid_make_channel_key'>make_channel_key</span> <span class='id identifier rubyid_channel'>channel</span>
	<span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span>
		<span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_channel_key'>channel_key</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#SUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::SUBSCRIBED (constant)">SUBSCRIBED</a></span></span> <span class='op'>==</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_messages_sent'>messages_sent</span> <span class='op'>+=</span> <span class='int'>1</span>
			<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>command:</span> <span class='const'><span class='object_link'><a href="Client/Command.html" title="EventMachine::ActionCable::Client::Command (module)">Command</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/Command.html#MESSAGE-constant" title="EventMachine::ActionCable::Client::Command::MESSAGE (constant)">MESSAGE</a></span></span><span class='comma'>,</span> <span class='label'>identifier:</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:txt</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>data:</span> <span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> send_message() ignored. No matching subscribed channel (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_channel_key'>channel_key</span><span class='embexpr_end'>}</span><span class='tstring_content'>).</span><span class='tstring_end'>&quot;</span></span> \
			<span class='kw'>if</span> <span class='id identifier rubyid_messages_sent'>messages_sent</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_messages_sent'>messages_sent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="state-instance_method">
  
    #<strong>state</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 251</span>

<span class='kw'>def</span> <span class='id identifier rubyid_state'>state</span>
	<span class='kw'>return</span> <span class='ivar'>@_state</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subscribe_to_channel-instance_method">
  
    #<strong>subscribe_to_channel</strong>(channel)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Subscribe to a channel (or indicate the desire to do so when the connection
is established). A string can be used (ie &#39;TestChannel&#39;) or a Hash
can be provided (ie { channel: &#39;TestChannel&#39;, myid: 123 }). If not
in a WELCOMED state, this is a channel that will be subscribed to once
welcomed.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>channel</span>
      
      
        <span class='type'>(<tt>String or Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Channel name, or hash containing &#39;channel&#39; attribute and other keys
that will be added to the subscription request (and all other requests on
the channel). Eg - { channel: &#39;ChatChannel&#39;, id: &#39;Bob&#39; }</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identifier for the channel</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 262</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subscribe_to_channel'>subscribe_to_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_channel'>channel</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_channel_key'>channel_key</span> <span class='op'>=</span> <span class='id identifier rubyid_make_channel_key'>make_channel_key</span> <span class='id identifier rubyid_channel'>channel</span>
	<span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='rbrace'>}</span>
		<span class='id identifier rubyid_rec'>rec</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>id:</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#UNSUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::UNSUBSCRIBED (constant)">UNSUBSCRIBED</a></span></span><span class='comma'>,</span> <span class='label'>txt:</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span><span class='rbrace'>}</span>
		<span class='ivar'>@_channels</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_rec'>rec</span>
		<span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Client/ConnectionState.html" title="EventMachine::ActionCable::Client::ConnectionState (module)">ConnectionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/ConnectionState.html#WELCOMED-constant" title="EventMachine::ActionCable::Client::ConnectionState::WELCOMED (constant)">WELCOMED</a></span></span> <span class='op'>==</span> <span class='ivar'>@_state</span>
			<span class='id identifier rubyid_rec'>rec</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#SUBSCRIBING-constant" title="EventMachine::ActionCable::Client::SubscriptionState::SUBSCRIBING (constant)">SUBSCRIBING</a></span></span>
			<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>command:</span> <span class='const'><span class='object_link'><a href="Client/Command.html" title="EventMachine::ActionCable::Client::Command (module)">Command</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/Command.html#SUBSCRIBE-constant" title="EventMachine::ActionCable::Client::Command::SUBSCRIBE (constant)">SUBSCRIBE</a></span></span><span class='comma'>,</span> <span class='label'>identifier:</span> <span class='id identifier rubyid_rec'>rec</span><span class='lbracket'>[</span><span class='symbol'>:txt</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>else</span>
		<span class='id identifier rubyid_channel_key'>channel_key</span> <span class='op'>=</span> <span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='rbrace'>}</span>
		<span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='embexpr_end'>}</span><span class='tstring_content'> subscribe_to_channel() ignored. Duplicate subscription to channel (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_channel_key'>channel_key</span><span class='embexpr_end'>}</span><span class='tstring_content'>).</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>

	<span class='kw'>return</span> <span class='id identifier rubyid_channel_key'>channel_key</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    #<strong>to_s</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


279
280
281</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 279</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
	<span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EventMachine::ActionCable::Client(</span><span class='embexpr_beg'>#{</span><span class='ivar'>@_uri</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsubscribe_from_channel-instance_method">
  
    #<strong>unsubscribe_from_channel</strong>(channel)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


283
284
285
286
287
288
289
290
291
292
293</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unsubscribe_from_channel'>unsubscribe_from_channel</span><span class='lparen'>(</span><span class='id identifier rubyid_channel'>channel</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_channel'>channel</span> <span class='op'>=</span> <span class='id identifier rubyid_make_channel_key'>make_channel_key</span> <span class='id identifier rubyid_channel'>channel</span>
	<span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span>
		<span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel'>channel</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
				<span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#SUBSCRIBING-constant" title="EventMachine::ActionCable::Client::SubscriptionState::SUBSCRIBING (constant)">SUBSCRIBING</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Client/SubscriptionState.html" title="EventMachine::ActionCable::Client::SubscriptionState (module)">SubscriptionState</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/SubscriptionState.html#SUBSCRIBED-constant" title="EventMachine::ActionCable::Client::SubscriptionState::SUBSCRIBED (constant)">SUBSCRIBED</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span><span class='rparen'>)</span>
			<span class='ivar'>@_connection</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>command:</span> <span class='const'><span class='object_link'><a href="Client/Command.html" title="EventMachine::ActionCable::Client::Command (module)">Command</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Client/Command.html#UNSUBSCRIBE-constant" title="EventMachine::ActionCable::Client::Command::UNSUBSCRIBE (constant)">UNSUBSCRIBE</a></span></span><span class='comma'>,</span> <span class='label'>identifier:</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:txt</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
	<span class='kw'>end</span>
	<span class='ivar'>@_channels</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span> <span class='id identifier rubyid_ch'>ch</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_channel'>channel</span><span class='rbrace'>}</span>
	<span class='kw'>return</span> <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="welcome_timeout-instance_method">
  
    #<strong>welcome_timeout</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 295</span>

<span class='kw'>def</span> <span class='id identifier rubyid_welcome_timeout'>welcome_timeout</span>
	<span class='kw'>return</span> <span class='ivar'>@_welcome_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="welcome_timeout=-instance_method">
  
    #<strong>welcome_timeout=</strong>(val)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/action_cable/client.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_welcome_timeout='>welcome_timeout=</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>&lt;=</span> <span class='int'>0</span>
	<span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
		<span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@_start_timer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span> <span class='op'>!=</span> <span class='ivar'>@_welcome_timeout</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_start_welcome_timer'>start_welcome_timer</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span> <span class='op'>&lt;=</span> <span class='ivar'>@_welcome_timeout</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='int'>0</span> <span class='op'>:</span> <span class='lparen'>(</span><span class='ivar'>@_welcome_timeout</span> <span class='op'>-</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span><span class='rparen'>)</span>
		<span class='kw'>end</span>
		<span class='ivar'>@_welcome_timeout</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
	<span class='kw'>else</span>
		<span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@_start_timer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='ivar'>@_start_timer</span><span class='period'>.</span><span class='id identifier rubyid_cancel'>cancel</span>
			<span class='ivar'>@_start_timer</span> <span class='op'>=</span> <span class='kw'>nil</span>
		<span class='kw'>end</span>
		<span class='ivar'>@_welcome_timeout</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='kw'>end</span>
	<span class='kw'>return</span> <span class='ivar'>@_welcome_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue May  7 15:10:36 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.5.0).
</div>

    </div>
  </body>
</html>